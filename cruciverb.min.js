/**
 * Cruciverb
 *
 * A JavaScript library that quickly creates interactive,
 * size-responsive, touch-capable crossword puzzles
 * for web pages.
 * 
 * @author Tim Scott Long
 * @copyright Tim Scott Long 2017-2021
 * @license Available for use under the MIT License
 */
var Cruciverb=function(){for(var e=null,t=!1,r="",l="",i=0,o=450,n=30,a="horizontal",s=document.body,d=!1,f=0,c=0,h=[],u=[],m=!1,g=!1,p=null,x=null,y=void 0,w=window.location.pathname.substr(window.location.pathname.lastIndexOf("/")+1,window.location.pathname.lastIndexOf(".html")-1-window.location.pathname.lastIndexOf("/"))+"-",b=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],S=[],v={Across:{},Down:{}},C={},T=0;T<b.length;T++)C[b[T]]=0;C.Backtab=0,C.Tab=0,C.Space=0,C.Backspace=0,C.Delete=0,C.Up=0,C.Down=0,C.Left=0,C.Right=0;var _=function(e,t,r,l,i){i.beginPath(),i.moveTo(e,t),i.lineTo(r,l),i.stroke()},A=function(e,t,r,l,i){i.save(),i.shadowColor="rgba(0, 0, 0, 0.35)",i.shadowOffsetX=1,i.shadowOffsetY=1,i.shadowBlur=4,i.fillStyle="rgb(230, 245, 255)",i.fillRect(e-2,t-2,r+4,l+4),i.restore()},k=function(i){i;var a=i.answers,d=i.clues,f=i.keyHighlights||!0;if(e=this,r=r||i.referenceLinkHref||"",l=l||i.referenceLinkName,(s=i.hostElement||s).classList.add("cruciverbHostElm"),y=i.onComplete||function(){},g||(s.innerHTML='<div id="topClue_div"></div><canvas id="cruciverb_canvas" width="450" height="450" ></canvas><div id="right_div"><div id="across_div"><h2>Across</h2><ul id="across_ul"></ul></div><div id="down_div"><h2>Down</h2><ul id="down_ul"></ul></div></div><br/><span id="theme_span"></span>'),void 0!==a){"string"==typeof a&&(a=a.split(""));for(var c=0,u=a.length;c<u;c++)S.push(a[c]),"_"===S[c]?h.push("_"):h.push("")}if(void 0!==d){for(var w in d.Across)v.Across[w]=d.Across[w];for(var w in d.Down)v.Down[w]=d.Down[w]}void 0===i.title&&void 0===i.theme||(document.getElementById("theme_span").innerHTML="Title: "+(i.title||i.theme)),p=document.getElementById("cruciverb_canvas"),x=p.getContext("2d"),o=Y(),n=X(),document.documentElement.clientWidth<=400?(document.body.style.margin="0",p.style.border="0",p.style.width=o+"px",p.style.height=o+"px",p.setAttribute("width",o+"px"),p.setAttribute("height",o+"px")):(p.style.width=o+"px",p.style.height=o+"px",p.setAttribute("width",o+"px"),p.setAttribute("height",o+"px")),t&&(p.style.height=o+6*n+"px",p.setAttribute("width",o+"px"),p.setAttribute("height",o+6*n+"px")),L(),K(),G(),m=!0,g||(U(S.indexOf("_")-1),R("across1_li"),p.addEventListener("click",F,!1),window.addEventListener("keydown",q,!1),window.addEventListener("touchstart",M,!1),f&&requestAnimationFrame(B),g=!0)},B=function(){for(var e in C)C[e]>0&&C[e]--;K(),requestAnimationFrame(B)};window.initializeCruciverb=k.prototype.constructor=k,window.addEventListener("resize",initializeCruciverb,!1);var M=function(){document.body.style.margin="0",p.style.border="0",p.style.width=o+"px",p.style.height=o+6*n+"px",p.setAttribute("width",o+"px"),p.setAttribute("height",o+6*n+"px"),t=!0,window.removeEventListener("touchstart",M,!1),K()},E=(k.prototype.savePuzzle=function(){for(var e=0,t=h.length;e<t;e++)localStorage.setItem(w+"enteredArray["+e+"]",h[e])},k.prototype.getCoordsFromSquare=function(e){return{x:n*(e%15),y:n*Math.floor(e/15)}}),I=(k.prototype.getSquareFromCoords=function(e,t){return"object"==typeof e&&(t=e.y,e=e.x),i=15*(t/=n)+(e/=n)},function(e,t,r){null!=document.getElementById("across"+(t+1)+"_li")&&"a"==r?(document.getElementById("across"+(t+1)+"_li").innerHTML=t+1+". "+v.Across[t+1],document.getElementById("across"+(t+1)+"_li").addEventListener("click",function(t){a="horizontal",V(e),H(e),R(this.id)},!1)):null!=document.getElementById("down"+(t+1)+"_li")&&"d"==r?(document.getElementById("down"+(t+1)+"_li").innerHTML=t+1+". "+v.Down[t+1],document.getElementById("down"+(t+1)+"_li").addEventListener("click",function(t){a="vertical",V(e),H(e),R(this.id)},!1)):setTimeout(function(){I(t)},100)}),R=function(e){for(var t=document.querySelectorAll("#right_div li"),r=0,l=t.length;r<l;r++)t[r].id==e?(t[r].style.backgroundColor="rgb(230, 245, 255)",document.getElementById("topClue_div").innerHTML=t[r].innerHTML):t[r].style.backgroundColor="white"},L=k.prototype.getSavedAnswers=function(){if(window.localStorage)for(T=0,len=S.length;T<len;T++)localStorage.getItem(w+"enteredArray["+T+"]")?h[T]=localStorage.getItem(w+"enteredArray["+T+"]"):"_"!==h[T]&&(h[T]=""),h[T]+""!="null"&&h[T]+""!="undefined"||(h[T]="")},z=function(e){if("horizontal"==a){R("across"+e+"_li");var t=document.getElementById("across"+e+"_li").offsetTop;document.getElementById("across_div").scrollTop=t}else{R("down"+e+"_li");t=document.getElementById("down"+e+"_li").offsetTop;document.getElementById("down_div").scrollTop=t}},F=function(e){var t=i,r=p.getBoundingClientRect();if(fingerX=e.clientX-r.left,fingerY=e.clientY-r.top,fingerY>Y())D(fingerX,fingerY-Y());else if(fingerX=Math.floor(fingerX/n),fingerY=Math.floor(fingerY/n),"_"!=S[15*fingerY+fingerX]){(i=15*fingerY+fingerX)==t&&P();var l=i;if("horizontal"==a){for(;"_"!==S[l]&&l%15!=0;)l--;for("_"===S[l]&&l++,N(l),l=i;"_"!==S[l]&&l%15!=14;)l++;U(l)}else{for(;"_"!==S[l]&&l>=0;)l-=15;for(N(l+=15),l=i;"_"!==S[l]&&l<=224;)l+=15;U(l)}K(),z(u[W()])}},D=function(e,t){var r={preventDefault:function(){},which:0,shiftKey:!1},l=3*n/2;Y();x.font=Math.floor(l/2)+"px Arial, sans-serif",t<=l?r.which=e<l?81:e<2*l?87:e<3*l?69:e<4*l?82:e<5*l?84:e<6*l?89:e<7*l?85:e<8*l?73:e<9*l?79:80:t<=2*l?r.which=e<l+n/2?65:e<2*l+n/2?83:e<3*l+n/2?68:e<4*l+n/2?70:e<5*l+n/2?71:e<6*l+n/2?72:e<7*l+n/2?74:e<8*l+n/2?75:76:t<=3*l?e<l?(r.which=9,r.shiftKey=!0):r.which=e<2*l?90:e<3*l?88:e<4*l?67:e<5*l?86:e<6*l?66:e<7*l?78:e<8*l?77:e<9*l?38:9:r.which=e<2.5*n?8:e<5.5*n?46:e<10.5*n?32:e<10.5*n+l?37:e<10.5*n+2*l?40:39,q(r)},H=function(e){if("horizontal"==a){for(;"_"!=S[e]&&e%15!=0;)e--;for("_"==S[e]&&e++,N(e),e=i;"_"!=S[e]&&e%15!=14;)e++;U(e)}else{for(;"_"!=S[e]&&e>=0;)e-=15;for(N(e+=15),e=i;"_"!=S[e]&&e<=224;)e+=15;U(e)}K()},q=k.prototype.keyHit=function(t){switch(t.preventDefault(),t.which){case 37:if(C.Left=10,0==i)i=S.length-1;else do{i--}while("_"===S[i]);break;case 39:C.Right=10,window.answerArray=S;do{i++,i%=S.length}while("_"===S[i]);break;case 38:C.Up=10;do{i<15&&(i+=S.length),i-=15}while(i<0||"_"===S[i]);break;case 40:C.Down=10;do{i>209&&(i-=225),i+=15}while(i>S.length||"_"===S[i]);break;case 32:C.Space=10,P();break;case 8:if(C.Backspace=10,"horizontal"==a){if(""===h[i]&&i>0)do{i--}while("_"===S[i]&&i>0)}else if(""===h[i]&&i>=15)do{i-=15}while("_"===S[i]&&i>=15);h[i]="",localStorage.setItem(w+"enteredArray["+i+"]","");break;case 46:C.Delete=10,h[i]="",localStorage.setItem(w+"enteredArray["+i+"]","");break;case 9:if(t.shiftKey)if(C.Backtab=10,0==i)i=S.length-1;else do{i--}while(!(i%15==0&&"_"!==S[i]||"_"===S[i-1]&&"_"!==S[i]));else if(C.Tab=10,i==S.length-1)i=0;else do{i++,i%=S.length}while(!(i%15==0&&"_"!==S[i]||"_"===S[i-1]&&"_"!==S[i]));break;default:if(t.which>=65&&t.which<=90)if(h[i]=b[t.which-65],C[b[t.which-65]]=10,localStorage.setItem(w+"enteredArray["+i+"]",h[i]),"horizontal"==a)do{i++,i%=S.length}while("_"===S[i]||"block"===S[i]);else do{i>209&&(i-=225),i+=15}while("_"===S[i])}K(),H(i),z(u[W()]),O()&&!d&&(Q(),y.call(e))},P=k.prototype.toggleDirection=function(){a="horizontal"==a?"vertical":"horizontal"},Y=k.prototype.getPuzzleWidth=function(){for(var e=Math.min(document.documentElement.clientWidth,450);e%15!=0;)e--;return e};k.prototype.getPuzzleHeight=function(){return Y()};var X=k.prototype.getSquareWidth=function(){return Y()/15},K=function(){x.clearRect(0,0,o,o),x.fillStyle="#FFFFAA",x.fillStyle="rgb(255, 255, 230)","horizontal"==a?x.fillRect(n*(W()%15),n*Math.floor(W()/15),J()*n,n):x.fillRect(n*(W()%15),n*Math.floor(W()/15),n,J()*n),x.strokeStyle="black";for(var e=Y(),t=X(),r=0;r<=e;r+=t)_(r,0,r,e,x),_(0,r,e,r,x);!function(){x.fillStyle="black";for(var e=0;e<225;e++)"_"==S[e]&&x.fillRect(n*(e%15),n*Math.floor(e/15),n,n)}(),function(){x.fillStyle="black",x.font=Math.max(Math.floor(n/3),5)+"px Arial, sans-serif",x.textBaseline="alphabetic";for(var e=0,t=0;t<225;t++)if("_"!=S[t]&&(t%15==0||t<15||t>=1&&"_"==S[t-1]||t>=15&&"_"==S[t-15])){var r;if(x.fillText(e+1,E(t).x+n/10,E(t).y+Math.max(n/3,5),n/2),u[t]=e+1,!m)(t%15==0||t>=1&&"_"==S[t-1])&&((r=document.createElement("LI")).id="across"+(e+1)+"_li",document.getElementById("across_ul").appendChild(r),I(t,e,"a")),(t<15||t>=15&&"_"==S[t-15])&&((r=document.createElement("LI")).id="down"+(e+1)+"_li",document.getElementById("down_ul").appendChild(r),I(t,e,"d"));e++}}(),x.strokeStyle="rgb(0, 0, 200)",x.strokeRect(n*(i%15),n*Math.floor(i/15),n,n),x.font=Math.floor(n/2)+"px Arial, sans-serif",x.textBaseline="middle";for(r=0;r<S.length;r++)"_"!=h[r]&&x.fillText(h[r]||"",E(r).x+n/2-x.measureText(h[r]||"").width/2,E(r).y+n/2);var l=["Q","W","E","R","T","Y","U","I","O","P","A","S","D","F","G","H","J","K","L","Z","X","C","V","B","N","M"],s=3*n/2,d=Y();x.font=Math.floor(.5*s)+"px Arial, sans-serif",x.textBaseline="middle",x.fillStyle="rgb(245, 250, 255)",x.fillRect(0,d,d,4*s),x.fillStyle="rgb(25, 25, 25)",x.strokeStyle="rgb(230, 245, 255)";for(r=0;r<10;r++)x.strokeRect(r*s,d,s,s),C[l[r]]>0?(A(r*s,d,s,s,x),x.fillStyle="rgb(25, 25, 25)",x.font=Math.floor(.6*s)+"px Arial, sans-serif",x.textBaseline="middle",x.fillText(l[r],r*s+s/2-x.measureText(l[r]).width/2,d+s/2)):(x.fillStyle="rgb(25, 25, 25)",x.font=Math.floor(.35*s)+"px Arial, sans-serif",x.textBaseline="middle",x.fillText(l[r],r*s+s/2-x.measureText(l[r]).width/2,d+s/2));x.fillStyle="rgb(25, 25, 25)",x.strokeStyle="rgb(230, 245, 255)",x.font=Math.floor(.5*n)+"px Arial, sans-serif";for(r=0;r<9;r++)x.strokeRect(n/2+r*s,d+s,s,s),C[l[r+10]]>0?(A(n/2+r*s,d+s,s,s,x),x.fillStyle="rgb(25, 25, 25)",x.font=Math.floor(.6*s)+"px Arial, sans-serif",x.textBaseline="middle",x.fillText(l[r+10],n/2+r*s+s/2-x.measureText(l[r+10]).width/2,d+3*s/2)):(x.fillStyle="rgb(25, 25, 25)",x.font=Math.floor(.35*s)+"px Arial, sans-serif",x.textBaseline="middle",x.fillText(l[r+10],n/2+r*s+s/2-x.measureText(l[r+10]).width/2,d+3*s/2));for(r=0;r<7;r++)x.strokeRect((r+1)*s,d+2*s,s,s),C[l[r+19]]>0?(A((r+1)*s,d+2*s,s,s,x),x.fillStyle="rgb(25, 25, 25)",x.font=Math.floor(.6*s)+"px Arial, sans-serif",x.textBaseline="middle",x.fillText(l[r+19],(r+1)*s+s/2-x.measureText(l[r+19]).width/2,d+5*s/2)):(x.fillStyle="rgb(25, 25, 25)",x.font=Math.floor(.35*s)+"px Arial, sans-serif",x.textBaseline="middle",x.fillText(l[r+19],(r+1)*s+s/2-x.measureText(l[r+19]).width/2,d+5*s/2));x.font=Math.floor(.35*s)+"px Arial, sans-serif",x.strokeRect(0,d+2*s,s,s),C.Backtab>0?(A(0,d+2*s,s,s,x),x.fillStyle="rgb(25, 25, 25)",x.font=Math.floor(.6*s)+"px Arial, sans-serif",x.textBaseline="middle",x.fillText(String.fromCharCode(171),s/2-x.measureText(String.fromCharCode(171)).width/2,d+2*s+s/2)):(x.fillStyle="rgb(25, 25, 25)",x.font=Math.floor(.35*s)+"px Arial, sans-serif",x.textBaseline="middle",x.fillText(String.fromCharCode(171),s/2-x.measureText(String.fromCharCode(171)).width/2,d+2*s+s/2)),x.strokeRect(9*s,d+2*s,s,s),C.Tab>0?(A(9*s,d+2*s,s,s,x),x.fillStyle="rgb(25, 25, 25)",x.font=Math.floor(.6*s)+"px Arial, sans-serif",x.textBaseline="middle",x.fillText(String.fromCharCode(187),9*s+s/2-x.measureText(String.fromCharCode(187)).width/2,d+2*s+s/2)):(x.fillStyle="rgb(25, 25, 25)",x.font=Math.floor(.35*s)+"px Arial, sans-serif",x.textBaseline="middle",x.fillText(String.fromCharCode(187),9*s+s/2-x.measureText(String.fromCharCode(187)).width/2,d+2*s+s/2)),x.strokeRect(0,d+3*s,2.5*n,s),C.Backspace>0?(A(0,d+3*s,2.5*n,s,x),x.fillStyle="rgb(25, 25, 25)",x.font=Math.floor(.6*s)+"px Arial, sans-serif",x.textBaseline="middle",x.fillText("BKSP",(s+n)/2-x.measureText("BKSP").width/2,d+3*s+s/2)):(x.fillStyle="rgb(25, 25, 25)",x.font=Math.floor(.35*s)+"px Arial, sans-serif",x.textBaseline="middle",x.fillText("BKSP",(s+n)/2-x.measureText("BKSP").width/2,d+3*s+s/2)),x.strokeRect(2.5*n,d+3*s,3*n,s),C.Delete>0?(A(2.5*n,d+3*s,3*n,s,x),x.fillStyle="rgb(25, 25, 25)",x.font=Math.floor(.6*s)+"px Arial, sans-serif",x.textBaseline="middle",x.fillText("DEL",s+n+(s+s)/2-x.measureText("DEL").width/2,d+3*s+s/2)):(x.fillStyle="rgb(25, 25, 25)",x.font=Math.floor(.35*s)+"px Arial, sans-serif",x.textBaseline="middle",x.fillText("DEL",s+n+(s+s)/2-x.measureText("DEL").width/2,d+3*s+s/2)),x.strokeRect(8*s,d+2*s,s,s),C.Up>0?(A(8*s,d+2*s,s,s,x),x.fillStyle="rgb(25, 25, 25)",x.font=Math.floor(.6*s)+"px Arial, sans-serif",x.textBaseline="middle",x.fillText(String.fromCharCode(8593),8.5*s-x.measureText(String.fromCharCode(8593)).width/2,d+2.5*s)):(x.fillStyle="rgb(25, 25, 25)",x.font=Math.floor(.35*s)+"px Arial, sans-serif",x.textBaseline="middle",x.fillText(String.fromCharCode(8593),8.5*s-x.measureText(String.fromCharCode(8593)).width/2,d+2.5*s)),x.strokeRect(10.5*n,d+3*s,s,s),C.Left>0?(A(10.5*n,d+3*s,s,s,x),x.fillStyle="rgb(25, 25, 25)",x.font=Math.floor(.6*s)+"px Arial, sans-serif",x.textBaseline="middle",x.fillText(String.fromCharCode(8592),7.5*s-x.measureText(String.fromCharCode(8592)).width/2,d+3.5*s)):(x.fillStyle="rgb(25, 25, 25)",x.font=Math.floor(.35*s)+"px Arial, sans-serif",x.textBaseline="middle",x.fillText(String.fromCharCode(8592),7.5*s-x.measureText(String.fromCharCode(8592)).width/2,d+3.5*s)),x.strokeRect(10.5*n+s,d+3*s,s,s),C.Down>0?(A(10.5*n+s,d+3*s,s,s,x),x.fillStyle="rgb(25, 25, 25)",x.font=Math.floor(.6*s)+"px Arial, sans-serif",x.textBaseline="middle",x.fillText(String.fromCharCode(8595),8.5*s-x.measureText(String.fromCharCode(8595)).width/2,d+3.5*s)):(x.fillStyle="rgb(25, 25, 25)",x.font=Math.floor(.35*s)+"px Arial, sans-serif",x.textBaseline="middle",x.fillText(String.fromCharCode(8595),8.5*s-x.measureText(String.fromCharCode(8595)).width/2,d+3.5*s)),x.strokeRect(10.5*n+2*s,d+3*s,s,s),C.Right>0?(A(10.5*n+2*s,d+3*s,s,s,x),x.fillStyle="rgb(25, 25, 25)",x.font=Math.floor(.6*s)+"px Arial, sans-serif",x.textBaseline="middle",x.fillText(String.fromCharCode(8594),9.5*s-x.measureText(String.fromCharCode(8594)).width/2,d+3.5*s)):(x.fillStyle="rgb(25, 25, 25)",x.font=Math.floor(.35*s)+"px Arial, sans-serif",x.textBaseline="middle",x.fillText(String.fromCharCode(8594),9.5*s-x.measureText(String.fromCharCode(8594)).width/2,d+3.5*s)),x.strokeRect(5.5*n,d+3*s,5*n,s),C.Space>0&&A(5.5*n,d+3*s,5*n,s,x)},O=k.prototype.isComplete=function(){for(var e=0;e<S.length;e++)if(S[e]!=h[e])return!1;return!0},W=k.prototype.getHighlightStart=function(){return f},N=k.prototype.setHighlightStart=function(e){f=e},U=(k.prototype.getHighlightEnd=function(){return c},k.prototype.setHighlightEnd=function(e){c=e}),V=(k.prototype.getPlayerSquarePos=function(){return i},k.prototype.setPlayerSquarePos=function(e){i=e,K()}),J=k.prototype.getHighlightLength=function(){return"horizontal"===a?c-f+1:(c-f+1)/15},G=(k.prototype.clearBoard=function(){for(var e=0;e<h.length;e++)"_"!=h[e]&&(h[e]="",localStorage.setItem(w+"enteredArray["+e+"]",""));initializeCruciverb({})},k.prototype.showAllAnswers=function(){for(var e=0;e<S.length;e++)h[e]=S[e],K()},function(){var e=document.createElement("DIV"),t=document.createElement("DIV"),r=document.createElement("H2"),l=document.createTextNode("Puzzle Completed");document.createTextNode("&times;");e.id="shadow_div",t.id="results_div",r.appendChild(l),t.appendChild(r),e.style.width="100%",e.style.height=document.documentElement.clientHeight+"px",e.style.position="fixed",e.style.top="0",e.style.left="0",e.style.backgroundColor="rgba(80, 80, 80, 0.3)",t.style.height="320px",t.style.backgroundColor="rgba(40, 40, 40, 0.8)",r.style.backgroundColor="transparent",r.style.width="90%",r.style.color="white",r.style.padding="0 5px",t.style.color="white",t.style.position="absolute",document.documentElement.clientWidth<=400?(t.style.width="100%",t.style.top="40px",t.style.left="0"):(t.style.width="300px",t.style.top="40px",t.style.left="40px"),t.style.margin="0 auto",s.appendChild(e),s.appendChild(t)}),Q=k.prototype.showResults=function(){d=!0;var e=document.getElementById("results_div");-1===e.innerHTML.indexOf("Check")?e.innerHTML+="<br/><br/>&nbsp;Check out more of our puzzles online!<br/><br/><br/>&nbsp;<strong><a href='"+r+"' style='color: white; text-decoration: none;'>"+l+"</a></strong><br/><br/><br/><br/>&nbsp;<small>JS crossword library by timlongcreative.com</small>":e.innerHTML+="<br/><br/><br/>&nbsp;&nbsp;&nbsp;Well done!",document.getElementById("shadow_div").style.display="block",e.style.display="block"};return k.prototype.enterFullScreen=function(e){void 0===e&&(e=document.documentElement),e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()},k.prototype.exitFullScreen=function(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()},k}();