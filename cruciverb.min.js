var Cruciverb=function(){var e=null,t=null,r=!1,n="",o="",l=0,a=450,s=30,c="horizontal",h=document.body,d=!1,u=0,f=0,w=[],y=[],p=!1,m=!1,g=null,A=null,v=void 0;prefix=window.location.pathname.substr(window.location.pathname.lastIndexOf("/")+1,window.location.pathname.lastIndexOf(".html")-1-window.location.pathname.lastIndexOf("/"))+"-",azArray=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],answerArray=[],cluesObj={Across:{},Down:{}};var x=function(e,t,r,n,i){i.beginPath(),i.moveTo(e,t),i.lineTo(r,n),i.stroke()},_=function(i){t=i;var l=i.answers,c=i.clues;if(e=this,n=n||i.referenceLinkHref||"",o=o||i.referenceLinkName,h=i.hostElement||h,h.classList.add("cruciverbHostElm"),v=i.onComplete||function(){},m||(h.innerHTML='<div id="topClue_div"></div><canvas id="cruciverb_canvas" width="450" height="450" ></canvas><div id="right_div"><div id="across_div"><h2>Across</h2><ul id="across_ul"></ul></div><div id="down_div"><h2>Down</h2><ul id="down_ul"></ul></div></div><br/><span id="theme_span"></span>'),"undefined"!=typeof l){"string"==typeof l&&(l=l.split(""));for(var d=0,u=l.length;u>d;d++)answerArray.push(l[d]),"_"===answerArray[d]?w.push("_"):w.push("")}if("undefined"!=typeof c){for(var f in c.Across)cluesObj.Across[f]=c.Across[f];for(var f in c.Down)cluesObj.Down[f]=c.Down[f]}"undefined"!=typeof i.theme&&(document.getElementById("theme_span").innerHTML="Theme: "+i.theme),g=document.getElementById("cruciverb_canvas"),A=g.getContext("2d"),a=H(),s=D(),document.documentElement.clientWidth<=400?(document.body.style.margin="0",g.style.border="0",g.style.width=a+"px",g.style.height=a+"px",g.setAttribute("width",a+"px"),g.setAttribute("height",a+"px")):(g.style.width=a+"px",g.style.height=a+"px",g.setAttribute("width",a+"px"),g.setAttribute("height",a+"px")),r&&(g.style.height=a+6*s+"px",g.setAttribute("width",a+"px"),g.setAttribute("height",a+6*s+"px")),I(),q(),K(),p=!0,m||(X(answerArray.indexOf("_")-1),T("across1_li"),g.addEventListener("click",F,!1),window.addEventListener("keydown",M,!1),window.addEventListener("touchstart",b,!1),m=!0)};window.initializeCruciverb=_.prototype.constructor=_,window.addEventListener("resize",initializeCruciverb,!1);var b=function(){document.body.style.margin="0",g.style.border="0",g.style.width=a+"px",g.style.height=a+6*s+"px",g.setAttribute("width",a+"px"),g.setAttribute("height",a+6*s+"px"),r=!0,window.removeEventListener("touchstart",b,!1)},E=(_.prototype.savePuzzle=function(){for(var e=0,t=w.length;t>e;e++)localStorage.setItem(prefix+"enteredArray["+e+"]",w[e])},_.prototype.getCoordsFromSquare=function(e){return{x:s*(e%15),y:s*Math.floor(e/15)}}),C=(_.prototype.getSquareFromCoords=function(e,t){return"object"==typeof e&&(t=e.y,e=e.x),e/=s,t/=s,l=15*t+e},function(){A.fillStyle="black";for(var e=0;225>e;e++)"_"==answerArray[e]&&A.fillRect(s*(e%15),s*Math.floor(e/15),s,s)}),k=function(){A.fillStyle="black",A.font=Math.max(Math.floor(s/3),5)+"px Arial sans-serif";for(var e=0,t=0;225>t;t++)if("_"!=answerArray[t]&&(t%15==0||15>t||t>=1&&"_"==answerArray[t-1]||t>=15&&"_"==answerArray[t-15])){if(A.fillText(e+1,E(t).x+s/10,E(t).y+Math.max(s/3,5),s/2),y[t]=e+1,!p){if(t%15==0||t>=1&&"_"==answerArray[t-1]){var r=document.createElement("LI");r.id="across"+(e+1)+"_li",document.getElementById("across_ul").appendChild(r),S(t,e,"a")}if(15>t||t>=15&&"_"==answerArray[t-15]){var r=document.createElement("LI");r.id="down"+(e+1)+"_li",document.getElementById("down_ul").appendChild(r),S(t,e,"d")}}e++}},S=function(e,t,r){null!=document.getElementById("across"+(t+1)+"_li")&&"a"==r?(document.getElementById("across"+(t+1)+"_li").innerHTML=t+1+". "+cluesObj.Across[t+1],document.getElementById("across"+(t+1)+"_li").addEventListener("click",function(t){c="horizontal",W(e),L(e),T(this.id)},!1)):null!=document.getElementById("down"+(t+1)+"_li")&&"d"==r?(document.getElementById("down"+(t+1)+"_li").innerHTML=t+1+". "+cluesObj.Down[t+1],document.getElementById("down"+(t+1)+"_li").addEventListener("click",function(t){c="vertical",W(e),L(e),T(this.id)},!1)):setTimeout(function(){S(t)},100)},T=function(e){for(var t=document.querySelectorAll("#right_div li"),r=0,n=t.length;n>r;r++)t[r].id==e?(t[r].style.backgroundColor="#DDDD77",document.getElementById("topClue_div").innerHTML=t[r].innerHTML):t[r].style.backgroundColor="white"},I=_.prototype.getSavedAnswers=function(){if(window.localStorage)for(i=0,len=answerArray.length;i<len;i++)localStorage.getItem(prefix+"enteredArray["+i+"]")?w[i]=localStorage.getItem(prefix+"enteredArray["+i+"]"):"_"!==w[i]&&(w[i]=""),(w[i]+""=="null"||w[i]+""=="undefined")&&(w[i]="")},z=function(e){if("horizontal"==c){T("across"+e+"_li");var t=document.getElementById("across"+e+"_li").offsetTop;document.getElementById("across_div").scrollTop=t}else{T("down"+e+"_li");var t=document.getElementById("down"+e+"_li").offsetTop;document.getElementById("down_div").scrollTop=t}},F=function(e){var t=l,r=g.getBoundingClientRect();if(fingerX=e.clientX-r.left,fingerY=e.clientY-r.top,fingerY>H())return void R(fingerX,fingerY-H());if(fingerX=Math.floor(fingerX/s),fingerY=Math.floor(fingerY/s),"_"!=answerArray[15*fingerY+fingerX]){l=15*fingerY+fingerX,l==t&&B();var n=l;if("horizontal"==c){for(;"_"!==answerArray[n]&&n%15!==0;)n--;for("_"===answerArray[n]&&n++,Y(n),n=l;"_"!==answerArray[n]&&n%15!==14;)n++;X(n)}else{for(;"_"!==answerArray[n]&&n>=0;)n-=15;for(n+=15,Y(n),n=l;"_"!==answerArray[n]&&224>=n;)n+=15;X(n)}q(),z(y[P()])}},R=function(e,t){var r={preventDefault:function(){},which:0,shiftKey:!1},n=3*s/2;H();A.font=Math.floor(n/2)+"px Arial",n>=t?n>e?r.which=81:2*n>e?r.which=87:3*n>e?r.which=69:4*n>e?r.which=82:5*n>e?r.which=84:6*n>e?r.which=89:7*n>e?r.which=85:8*n>e?r.which=73:9*n>e?r.which=79:r.which=80:2*n>=t?n+s/2>e?r.which=65:2*n+s/2>e?r.which=83:3*n+s/2>e?r.which=68:4*n+s/2>e?r.which=70:5*n+s/2>e?r.which=71:6*n+s/2>e?r.which=72:7*n+s/2>e?r.which=74:8*n+s/2>e?r.which=75:r.which=76:3*n>=t?n>e?(r.which=9,r.shiftKey=!0):2*n>e?r.which=90:3*n>e?r.which=88:4*n>e?r.which=67:5*n>e?r.which=86:6*n>e?r.which=66:7*n>e?r.which=78:8*n>e?r.which=77:9*n>e?r.which=38:r.which=9:2.5*s>e?r.which=8:5.5*s>e?r.which=46:10.5*s>e?r.which=32:10.5*s+n>e?r.which=37:10.5*s+2*n>e?r.which=40:r.which=39,M(r)},L=function(e){if("horizontal"==c){for(;"_"!=answerArray[e]&&e%15!=0;)e--;for("_"==answerArray[e]&&e++,Y(e),e=l;"_"!=answerArray[e]&&e%15!=14;)e++;X(e)}else{for(;"_"!=answerArray[e]&&e>=0;)e-=15;for(e+=15,Y(e),e=l;"_"!=answerArray[e]&&224>=e;)e+=15;X(e)}q()},M=_.prototype.keyHit=function(t){if(t.preventDefault(),37==t.which)if(0==l)l=answerArray.length-1;else do l--;while("_"===answerArray[l]);else if(39==t.which){window.answerArray=answerArray;do l++,l%=answerArray.length;while("_"===answerArray[l])}else if(38==t.which){do 15>l&&(l+=answerArray.length),l-=15;while(0>l||"_"===answerArray[l])}else if(40==t.which){do l>209&&(l-=225),l+=15;while(l>answerArray.length||"_"===answerArray[l])}else if(32==t.which)B();else if(8==t.which){if("horizontal"==c){if(""===w[l]&&l>0)do l--;while("_"===answerArray[l]&&l>0)}else if(""===w[l]&&l>=15)do l-=15;while("_"===answerArray[l]&&l>=15);w[l]="",localStorage.setItem(prefix+"enteredArray["+l+"]","")}else if(46==t.which)w[l]="",localStorage.setItem(prefix+"enteredArray["+l+"]","");else if(9==t.which)if(t.shiftKey)if(0==l)l=answerArray.length-1;else do l--;while(!(l%15===0&&"_"!==answerArray[l]||"_"===answerArray[l-1]&&"_"!==answerArray[l]));else if(l==answerArray.length-1)l=0;else do l++,l%=answerArray.length;while(!(l%15===0&&"_"!==answerArray[l]||"_"===answerArray[l-1]&&"_"!==answerArray[l]));else if(t.which>=65&&t.which<=90)if(w[l]=azArray[t.which-65],localStorage.setItem(prefix+"enteredArray["+l+"]",w[l]),"horizontal"==c){do l++,l%=answerArray.length;while("_"===answerArray[l]||"block"===answerArray[l])}else do l>209&&(l-=225),l+=15;while("_"===answerArray[l]);q(),L(l),z(y[P()]),O()&&!d&&(N(),v.call(e))},B=_.prototype.toggleDirection=function(){c="horizontal"==c?"vertical":"horizontal"},H=_.prototype.getPuzzleWidth=function(){for(var e=Math.min(document.documentElement.clientWidth,450);e%15!==0;)e--;return e};_.prototype.getPuzzleHeight=function(){return H()};var D=_.prototype.getSquareWidth=function(){return H()/15},q=function(){A.clearRect(0,0,a,a),A.fillStyle="#FFFFAA","horizontal"==c?A.fillRect(s*(P()%15),s*Math.floor(P()/15),j()*s,s):A.fillRect(s*(P()%15),s*Math.floor(P()/15),s,j()*s),A.strokeStyle="black";for(var e=H(),t=D(),r=0;e>=r;r+=t)x(r,0,r,e,A),x(0,r,e,r,A);C(),k(),A.strokeStyle="blue",A.strokeRect(s*(l%15),s*Math.floor(l/15),s,s),A.font=Math.floor(s/2)+"px Arial sans-serif";for(var r=0;r<answerArray.length;r++)"_"!=w[r]&&A.fillText(w[r]||"",E(r).x+s/3,E(r).y+7*(s/10));var n=["Q","W","E","R","T","Y","U","I","O","P","A","S","D","F","G","H","J","K","L","Z","X","C","V","B","N","M"],i=3*s/2,o=H();A.font=Math.floor(i/2)+"px Arial",A.fillStyle="#EEEEFF",A.fillRect(0,o,o,4*i),A.fillStyle="black";for(var r=0;10>r;r++)A.strokeRect(r*i,o,i,i),A.fillText(n[r],r*i+i/3,o+2*i/3);for(var r=0;9>r;r++)A.strokeRect(s/2+r*i,o+i,i,i),A.fillText(n[r+10],r*i+2*i/3,o+5*i/3);for(var r=0;7>r;r++)A.strokeRect((r+1)*i,o+2*i,i,i),A.fillText(n[r+19],(r+1)*i+i/3,o+8*i/3);A.strokeRect(0,o+2*i,i,i),A.strokeRect(9*i,o+2*i,i,i),A.fillText(String.fromCharCode(171),i/3,o+2*i+2*i/3),A.fillText(String.fromCharCode(187),9*i+i/3,o+2*i+2*i/3),A.strokeRect(8*i,o+2*i,i,i),A.strokeRect(0,o+3*i,2.5*s,i),A.strokeRect(2.5*s,o+3*i,3*s,i),A.strokeRect(5.5*s,o+3*i,5*s,i),A.strokeRect(10.5*s,o+3*i,i,i),A.strokeRect(10.5*s+i,o+3*i,i,i),A.strokeRect(10.5*s+2*i,o+3*i,i,i),A.fillText("BKSP",i/5,o+11*i/3),A.fillText("DEL",2.5*s+i/2,o+11*i/3),A.fillText(String.fromCharCode(8593),8.4*i,o+8*i/3),A.fillText(String.fromCharCode(8592),7.2*i,o+11*i/3),A.fillText(String.fromCharCode(8595),8.4*i,o+11*i/3),A.fillText(String.fromCharCode(8594),9.3*i,o+11*i/3)},O=_.prototype.isComplete=function(){for(var e=0;e<answerArray.length;e++)if(answerArray[e]!=w[e])return!1;return!0},P=_.prototype.getHighlightStart=function(){return u},Y=_.prototype.setHighlightStart=function(e){u=e},X=(_.prototype.getHighlightEnd=function(){return f},_.prototype.setHighlightEnd=function(e){f=e}),W=(_.prototype.getPlayerSquarePos=function(){return l},_.prototype.setPlayerSquarePos=function(e){l=e,q()}),j=_.prototype.getHighlightLength=function(){return"horizontal"===c?f-u+1:(f-u+1)/15},K=(_.prototype.clearBoard=function(){for(var e=0;e<w.length;e++)"_"!=w[e]&&(w[e]="",localStorage.setItem(prefix+"enteredArray["+e+"]",""));initializeCruciverb({})},_.prototype.showAllAnswers=function(){for(var e=0;e<answerArray.length;e++)w[e]=answerArray[e],q()},function(){var e=document.createElement("DIV"),t=document.createElement("DIV"),r=document.createElement("H2"),n=document.createTextNode("Puzzle Completed");document.createTextNode("&times;");e.id="shadow_div",t.id="results_div",r.appendChild(n),t.appendChild(r),e.style.width="100%",e.style.height=document.documentElement.clientHeight+"px",e.style.position="fixed",e.style.top="0",e.style.left="0",e.style.backgroundColor="rgba(80, 80, 80, 0.3)",t.style.height="320px",t.style.backgroundColor="rgba(40, 40, 40, 0.8)",r.style.backgroundColor="transparent",r.style.width="90%",r.style.color="white",r.style.padding="0 5px",t.style.color="white",t.style.position="absolute",document.documentElement.clientWidth<=400?(t.style.width="100%",t.style.top="40px",t.style.left="0"):(t.style.width="300px",t.style.top="40px",t.style.left="40px"),t.style.margin="0 auto",h.appendChild(e),h.appendChild(t)}),N=_.prototype.showResults=function(){d=!0;var e=document.getElementById("results_div");-1===e.innerHTML.indexOf("Check")?e.innerHTML+="<br/><br/>&nbsp;Check out more of our puzzles online!<br/><br/><br/>&nbsp;<strong><a href='"+n+"' style='color: white; text-decoration: none;'>"+o+"</a></strong><br/><br/><br/><br/>&nbsp;<small>JS crossword library by timlongcreative.com</small>":e.innerHTML+="<br/><br/><br/>&nbsp;&nbsp;&nbsp;Well done!",document.getElementById("shadow_div").style.display="block",e.style.display="block"};return _.prototype.enterFullScreen=function(e){"undefined"==typeof e&&(e=document.documentElement),e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()},_.prototype.exitFullScreen=function(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()},_}();